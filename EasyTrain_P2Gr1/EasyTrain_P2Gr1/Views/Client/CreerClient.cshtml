@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@model EasyTrain_P2Gr1.Models.Client

@{
    Layout = "_LayoutVisiteur";
}

@if (TempData.ContainsKey("Message"))
{
    <div class="message">@TempData["Message"]</div>
}

<div class="container" id="registration-form" style="height: 100VH; padding-top:10em"> 

    @using (Html.BeginForm("CreerClient", "VotreController", FormMethod.Post, new { id = "client-form" }))
            {
            <div id="step1">
            <div>
                @Html.LabelFor(c => c.Abonnement.ReservEquipement)
                @Html.CheckBoxFor(c => c.Abonnement.ReservEquipement, new { @id = "ReservEquipement" })
                <br />
                @Html.LabelFor(c => c.Abonnement.AccesPiscine)
                @Html.CheckBoxFor(c => c.Abonnement.AccesPiscine, new { @id = "AccesPiscine" })
            </div>
            <button id="next-step">Étape suivante</button>
        </div>

    <div id="step2" style="display: none;">

            <div class="fieldsetModifier">
                <fieldset>
                    <legend><h2>Inscription</h2></legend>

                    @Html.Partial("_CreerUtilisateur")

                    <div class="btnCoachModifier">
                        <input type="submit" value="Confirmer" />
                    </div>
                </fieldset>
            </div>

    </div>}
</div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>$(document).ready(function () {
    $("#next-step").click(function () {
        $("#step1").slideUp("fast", function () {
            $("#step2").slideDown("fast");
        });
    });

    $("#client-form").submit(function (e) {
        e.preventDefault();
        var formData = $(this).serializeArray();
        console.log(formData);
        
        formData.push({ name: "Abonnement.ReservEquipement", value: $("#ReservEquipement").is(":checked") });
        formData.push({ name: "Abonnement.AccesPiscine", value: $("#AccesPiscine").is(":checked") });

        $.ajax({
            type: "POST",
            url: "@Url.Action("CreerClient", "Client")",
            data: formData,
            success: function (data) {
                console.log("Le client a été créé avec succès.");

            },
            error: function () {
                console.log("Une erreur s'est produite lors de la création du client.");
            }
        });
    });
});</script>

